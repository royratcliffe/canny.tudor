<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pairwise Zipping • canny.tudor</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Pairwise Zipping">
<meta property="og:description" content="canny.tudor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">canny.tudor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pairwise-zipping.html">Pairwise Zipping</a>
    </li>
    <li>
      <a href="../articles/tibble-type.html">Tibble Type</a>
    </li>
    <li>
      <a href="../articles/unzip-raw-binary.html">Unzip Raw Binary</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Pairwise Zipping</h1>
            
      
      
      <div class="hidden name"><code>pairwise-zipping.Rmd</code></div>

    </div>

    
    
<p>Some languages and systems (Erlang, Redis) treat implied list pairs as a special data structure. Named R lists can transform to flat lists where the first element in each pairing retains the name, and where the value takes the second pairing position. Development iterations pursue three alternative approaches to the forward and reverse transformation operations, all using R’s base function library only.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Various computing applications apply the concept of a flattened and interlaced <em>pairwise list</em> or list of pairs. Erlang utilises a list of implied two-element tuple pairings for configuration terms, called <a href="https://www.erlang.org/doc/man/proplists.html" class="external-link">property lists</a> (STDLIB User’s Guide, Erlang, Ericsson AB, Stockholm, Sweden). Redis applies the identical concept within its streaming interface where an event corresponds to a flat list of interlaced keys and values. An example of such a list appears below, in R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unnamed_pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"key1"</span>, <span class="st">"value1"</span>, <span class="st">"key2"</span>, <span class="st">"value2"</span><span class="op">)</span></span></code></pre></div>
<p>Operations on such lists exist:</p>
<ul>
<li>pairing up keys and values from lists of lists;</li>
<li>reversing that process by flattening nested lists but by only one level; and</li>
<li>finding the value (or values because uniqueness <strong>not</strong> guaranteed) of some given key.</li>
</ul>
<p>Extending a pair list proves easy: just append the new key and value. Structuring and de-structuring is another story yet an important one for situations where software components require a translation to and from implied pairs. Two complementary operations flatten and de-interlace pairs would be quite handy for such scenarios in R.</p>
</div>
<div class="section level2">
<h2 id="iteratative-development">Iteratative development<a class="anchor" aria-label="anchor" href="#iteratative-development"></a>
</h2>
<p>The experimental steps below attempt to simplify structuring operations with list pairs. Keep it simple but make it reliable, correctly failing when pairing proves impossible.</p>
<div class="section level3">
<h3 id="first-notion">First notion<a class="anchor" aria-label="anchor" href="#first-notion"></a>
</h3>
<p>Assume that <span class="math inline">\(x\)</span> is a named list. The function below applies its names to its scalar elements by multi-variate application of the <code>list</code> function. It does not simplify the result; the outcome is a nested list of lists. Nor does it apply names to the resulting super-list.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">named_pairs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">list</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">x</span>, SIMPLIFY <span class="op">=</span> <span class="cn">FALSE</span>, USE.NAMES <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Worth noting that R list names are character vectors of names. The list’s name vector in R is <code>NULL</code> (an empty vector) if the list has no names. List names default to an empty string when lists mix named and unnamed elements. List elements may share the same name, not unique as if the list were a map. R automatically encapsulates that notable feature of pair lists.</p>
<p>Applying the function <code>unlist</code> to the result will flatten the list. No recursion needs to apply (calling <code>unlist(x, recursive = FALSE)</code> where <code>x</code> binds some pair list) because only two levels of nesting concern pairwise decomposition. Flattening to a vector using <code>unlist</code> also unifies their type; numbers become strings, logical <code>TRUE</code> becomes string <code>"TRUE"</code>. Sub-lists become <code>NULL</code> however.</p>
</div>
<div class="section level3">
<h3 id="second-notion-sequence-generation">Second notion, sequence generation<a class="anchor" aria-label="anchor" href="#second-notion-sequence-generation"></a>
</h3>
<p>Generate indices and apply them to the list by sub-setting. Assumes that list positions translate to one-based contiguous integer indices—a safe assumption.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unzip</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0L</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">2L</span> <span class="op">*</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">named</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">named</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">named</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>  <span class="va">named</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To zip or unzip? That is the question! The previous function calls it “zip,” the procedure for taking a flat list and building a named list. Not necessarily the best name. Imagination conjures other possibilities: flatten, unflatten, interlace, de-interlace. If zip, the reverse naturally becomes “unzip.”</p>
<div class="section level4">
<h4 id="sequences-of-indices">Sequences of indices<a class="anchor" aria-label="anchor" href="#sequences-of-indices"></a>
</h4>
<p>“Pairs to named list” using <code>seq</code> to generate the index sequences:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zip</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0L</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="st">"length must be even"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2L</span> <span class="op">==</span> <span class="fl">0L</span><span class="op">)</span></span>
<span>  <span class="va">named</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">named</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">named</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Disadvantageously, the implementation presumes sequence <span class="math inline">\(1\ldots n\)</span> gives the correct list indices, or more mathematically, the inclusive interval <span class="math inline">\([1,n]\)</span> where <span class="math inline">\(\{i|1\leq i\leq n,n\in\mathbb{Z}\}\)</span>. R makes this true in all if not almost all imaginable cases. Yet better if the implementation does not care about indexing details and therefore makes no assumptions about where they start and finish.</p>
<p>Still, a step in the right direction.</p>
</div>
</div>
<div class="section level3">
<h3 id="final-notion-matrix-sub-setting-pure-base">Final notion, matrix sub-setting, pure base<a class="anchor" aria-label="anchor" href="#final-notion-matrix-sub-setting-pure-base"></a>
</h3>
<p>The final approach attempts a pure matrix sub-setting strategy. It only uses <code><a href="https://rdrr.io/r/base/seq.html" class="external-link">base::seq_along</a></code> for indexing because it collapses predictably for empty lists, and fails for non-even lists, without requiring additional tests and conditional execution. Nor does it make assumptions about one-based indexing, an additional bonus.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flatten_named.list</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">2L</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">unnamed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">unnamed</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>  <span class="va">unnamed</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">unnamed</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Its complement:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unflatten_named.list</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">2L</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2L</span>, <span class="fl">2L</span><span class="op">)</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span><span class="op">[</span>, <span class="fl">1L</span><span class="op">]</span></span>
<span>  <span class="va">named</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">named</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">]</span></span>
<span>  <span class="va">named</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Some redundancy exists. Expression <code>2L * seq_along(x)</code> unnecessarily multiplies the second half of the indices by two which the function subsequently ignores and then throws into the trash bin. Only the first column has interesting indices: those of the even-indexed values. Subtracting one from these gives the corresponding keys.</p>
<div class="section level4">
<h4 id="wrong-dimensions">Wrong dimensions<a class="anchor" aria-label="anchor" href="#wrong-dimensions"></a>
</h4>
<p>Applying the dimensions by halving the length catches odd-length errors; the product of the dimension must match the length.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/unflatten_named.list.html">unflatten_named.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fl">1</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in dim(i) &lt;- c(length(x)/2L, 2L): dims [product 2] do not match the length of object [3]</span></span></code></pre></div>
<p>Failure is the correct response.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<ul>
<li><p>Basic matrix-oriented R sub-setting adds useful advantages: simple, collapses predicable, requires no conditionals. Matrix means a vector with added dimensions.</p></li>
<li><p>The function names have developed during development: unzip and zip; flatten and unflatten. The subject of the operation: a named list or an unnamed list.</p></li>
<li><p>Note that keys are <strong>not</strong> unique. The pairwise list is <em>not</em> a map or dictionary.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Roy Ratcliffe.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
